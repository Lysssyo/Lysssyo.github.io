---
date created: 2026-01-14 20:16:30
date modified: 2026-01-15 00:05:31
---
# 跨域

# 1. 什么是跨域

“跨域”（Cross-Origin）全称是 **Cross-Origin Resource Sharing (CORS)** 机制所针对的场景。

在浏览器眼里，一个“域”必须由 **三个死板的要素** 组成，只要有一个不一样，就是“跨域”：

1. **协议** (Protocol)：如 `http` 和 `https` 是不同的。
2. **域名** (Domain)：如 `localhost` 和 `baidu.com` 是不同的。
3. **端口** (Port)：如 `:80` 和 `:8080` 是不同的。

例如：

- **你的前端（起点）**：`http://localhost:5173`
- **你的后端（终点）**：`https://privatege-proxy...fcapp.run` (默认端口 443)

| **比较要素** | **前端**    | **后端**       | **结果** |
| -------- | --------- | ------------ | ------ |
| **协议**   | http      | https        | ❌ 不同   |
| **域名**   | localhost | ...fcapp.run | ❌ 不同   |
| **端口**   | 5173      | 443          | ❌ 不同   |

这就叫做跨域。

# 2. 为什么要有这个限制

但如果没有这个限制，互联网将极其危险。想象下面这个场景：

1. 你刚刚登录了 **银行网站 (`bank.com`)**，浏览器里存着你的登录凭证（Cookie）。
2. 你不小心点开了一个 **恶意网站 (`evil.com`)**。
3. 如果没有跨域限制，`evil.com` 里的 JavaScript 代码就可以直接向 `bank.com` 发送请求：“**把这个人的钱转给我！**”
4. 因为你已经登录了银行，`bank.com` 看到请求带着你的 Cookie，就会以为是你自己操作的，于是钱就丢了。

**浏览器的“同源策略”（Same-Origin Policy）** 就是为了阻止这种事情：

> **浏览器规定**：`evil.com` 的页面，禁止读取 `bank.com` 的数据，除非 `bank.com` 明确点头同意。

# 3. 什么是 CORS

既然默认是禁止的，那正常的跨域需求（比如你的前端调后端）怎么办？ 这时候就需要 **CORS**（Cross-Origin Resource Sharing，跨域资源共享）这套机制了。

CORS 就像是一个**“通行证制度”**：

1. **浏览器（保安）**：看到你要从 `localhost` 去访问 `fcapp.run`，便把请求拦下（或者先发个 OPTIONS 问问）。
2. **浏览器问后端**：“我是 `localhost` 的人，想拿数据，行不行？”
3. **后端（服务器）**：如果后端在响应头里写了： `Access-Control-Allow-Origin: *` （所有人都可以进） 或者 `Access-Control-Allow-Origin: http://localhost:5173` （只准你进）
4. **浏览器放行**：保安看到通行证，才把数据交给你。

> [!WARNING] 只能有一个Access-Control-Allow-Origin
> 响应头只能有一个`Access-Control-Allow-Origin`，即使两个都是 `Access-Control-Allow-Origin: *` 也不行！